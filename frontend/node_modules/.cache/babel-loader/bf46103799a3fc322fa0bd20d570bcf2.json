{"ast":null,"code":"var _jsxFileName = \"/Users/kaualandi/dev/atendechat-novo-main/frontend/src/components/MessageInputCustom/index.js\";\nimport React, { useState, useEffect, useContext, useRef } from \"react\";\nimport withWidth, { isWidthUp } from \"@material-ui/core/withWidth\";\nimport \"emoji-mart/css/emoji-mart.css\";\nimport { Picker } from \"emoji-mart\";\nimport MicRecorder from \"mic-recorder-to-mp3\";\nimport clsx from \"clsx\";\nimport { isNil } from \"lodash\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { green } from \"@material-ui/core/colors\";\nimport AttachFileIcon from \"@material-ui/icons/AttachFile\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MoodIcon from \"@material-ui/icons/Mood\";\nimport SendIcon from \"@material-ui/icons/Send\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport CheckCircleOutlineIcon from \"@material-ui/icons/CheckCircleOutline\";\nimport HighlightOffIcon from \"@material-ui/icons/HighlightOff\";\nimport VisibilityIcon from '@mui/icons-material/Visibility';\nimport VisibilityOffIcon from '@mui/icons-material/VisibilityOff';\nimport { FormControlLabel, Switch } from \"@material-ui/core\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport { isString, isEmpty, isObject, has } from \"lodash\";\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport axios from \"axios\";\nimport RecordingTimer from \"./RecordingTimer\";\nimport { ReplyMessageContext } from \"../../context/ReplyingMessage/ReplyingMessageContext\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { useLocalStorage } from \"../../hooks/useLocalStorage\";\nimport toastError from \"../../errors/toastError\";\nimport useQuickMessages from \"../../hooks/useQuickMessages\";\nconst Mp3Recorder = new MicRecorder({\n  bitRate: 128\n});\nconst useStyles = makeStyles(theme => ({\n  mainWrapper: {\n    backgroundColor: theme.palette.bordabox,\n    //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\"\n  },\n  newMessageBox: {\n    backgroundColor: theme.palette.newmessagebox,\n    //DARK MODE PLW DESIGN//\n    width: \"100%\",\n    display: \"flex\",\n    padding: \"7px\",\n    alignItems: \"center\"\n  },\n  messageInputWrapper: {\n    padding: 6,\n    marginRight: 7,\n    backgroundColor: theme.palette.inputdigita,\n    //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    borderRadius: 20,\n    flex: 1\n  },\n  messageInput: {\n    paddingLeft: 10,\n    flex: 1,\n    border: \"none\"\n  },\n  sendMessageIcons: {\n    color: \"grey\"\n  },\n  uploadInput: {\n    display: \"none\"\n  },\n  viewMediaInputWrapper: {\n    display: \"flex\",\n    padding: \"10px 13px\",\n    position: \"relative\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    backgroundColor: \"#eee\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\"\n  },\n  emojiBox: {\n    position: \"absolute\",\n    bottom: 63,\n    width: 40,\n    borderTop: \"1px solid #e8e8e8\"\n  },\n  circleLoading: {\n    color: green[500],\n    opacity: \"70%\",\n    position: \"absolute\",\n    top: \"20%\",\n    left: \"50%\",\n    marginLeft: -12\n  },\n  audioLoading: {\n    color: green[500],\n    opacity: \"70%\"\n  },\n  recorderWrapper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    alignContent: \"middle\"\n  },\n  cancelAudioIcon: {\n    color: \"red\"\n  },\n  sendAudioIcon: {\n    color: \"green\"\n  },\n  replyginMsgWrapper: {\n    display: \"flex\",\n    width: \"100%\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingTop: 8,\n    paddingLeft: 73,\n    paddingRight: 7\n  },\n  replyginMsgContainer: {\n    flex: 1,\n    marginRight: 5,\n    overflowY: \"hidden\",\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\n    borderRadius: \"7.5px\",\n    display: \"flex\",\n    position: \"relative\"\n  },\n  replyginMsgBody: {\n    padding: 10,\n    height: \"auto\",\n    display: \"block\",\n    whiteSpace: \"pre-wrap\",\n    overflow: \"hidden\"\n  },\n  replyginContactMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#35cd96\"\n  },\n  replyginSelfMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#6bcbef\"\n  },\n  messageContactName: {\n    display: \"flex\",\n    color: \"#6bcbef\",\n    fontWeight: 500\n  }\n}));\nconst EmojiOptions = props => {\n  const {\n    disabled,\n    showEmoji,\n    setShowEmoji,\n    handleAddEmoji\n  } = props;\n  const classes = useStyles();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"emojiPicker\",\n    component: \"span\",\n    disabled: disabled,\n    onClick: e => setShowEmoji(prevState => !prevState),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(MoodIcon, {\n    className: classes.sendMessageIcons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }\n  })), showEmoji ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.emojiBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Picker, {\n    perLine: 16,\n    showPreview: false,\n    showSkinTones: false,\n    onSelect: handleAddEmoji,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 11\n    }\n  })) : null);\n};\nconst SignSwitch = props => {\n  const {\n    width,\n    setSignMessage,\n    signMessage\n  } = props;\n  if (isWidthUp(\"md\", width)) {\n    return /*#__PURE__*/React.createElement(FormControlLabel, {\n      style: {\n        marginRight: 7,\n        color: \"gray\"\n      },\n      label: i18n.t(\"messagesInput.signMessage\"),\n      labelPlacement: \"start\",\n      control: /*#__PURE__*/React.createElement(Switch, {\n        size: \"small\",\n        checked: signMessage,\n        onChange: e => {\n          setSignMessage(e.target.checked);\n        },\n        name: \"showAllTickets\",\n        color: \"primary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 7\n      }\n    });\n  }\n  return null;\n};\nconst FileInput = props => {\n  const {\n    handleChangeMedias,\n    disableOption\n  } = props;\n  const classes = useStyles();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"input\", {\n    multiple: true,\n    type: \"file\",\n    id: \"upload-button\",\n    disabled: disableOption(),\n    className: classes.uploadInput,\n    onChange: handleChangeMedias,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"upload-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"upload\",\n    component: \"span\",\n    disabled: disableOption(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(AttachFileIcon, {\n    className: classes.sendMessageIcons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 11\n    }\n  }))));\n};\nconst VisibilitySwitch = props => {\n  const {\n    setVisibility,\n    visibility\n  } = props;\n  const VisibilityStatusIcon = visibility ? VisibilityIcon : VisibilityOffIcon;\n  return /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"visibility\",\n    component: \"span\",\n    onClick: () => setVisibility(!visibility),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(VisibilityStatusIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 7\n    }\n  }));\n};\nconst ActionButtons = props => {\n  const {\n    inputMessage,\n    loading,\n    recording,\n    ticketStatus,\n    handleSendMessage,\n    handleCancelAudio,\n    handleUploadAudio,\n    handleStartRecording\n  } = props;\n  const classes = useStyles();\n  if (inputMessage) {\n    return /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"sendMessage\",\n      component: \"span\",\n      onClick: handleSendMessage,\n      disabled: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(SendIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }\n    }));\n  } else if (recording) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.recorderWrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"cancelRecording\",\n      component: \"span\",\n      fontSize: \"large\",\n      disabled: loading,\n      onClick: handleCancelAudio,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(HighlightOffIcon, {\n      className: classes.cancelAudioIcon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 11\n      }\n    })), loading ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      className: classes.audioLoading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 13\n      }\n    })) : /*#__PURE__*/React.createElement(RecordingTimer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"sendRecordedAudio\",\n      component: \"span\",\n      onClick: handleUploadAudio,\n      disabled: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(CheckCircleOutlineIcon, {\n      className: classes.sendAudioIcon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 11\n      }\n    })));\n  } else {\n    return /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"showRecorder\",\n      component: \"span\",\n      disabled: loading || ticketStatus !== \"open\",\n      onClick: handleStartRecording,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(MicIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }\n    }));\n  }\n};\nconst CustomInput = props => {\n  const {\n    loading,\n    inputRef,\n    ticketStatus,\n    inputMessage,\n    setInputMessage,\n    handleSendMessage,\n    handleInputPaste,\n    disableOption,\n    handleQuickAnswersClick\n  } = props;\n  const classes = useStyles();\n  const [quickMessages, setQuickMessages] = useState([]);\n  const [options, setOptions] = useState([]);\n  const [popupOpen, setPopupOpen] = useState(false);\n  const {\n    user\n  } = useContext(AuthContext);\n  const {\n    list: listQuickMessages\n  } = useQuickMessages();\n  useEffect(() => {\n    async function fetchData() {\n      const companyId = localStorage.getItem(\"companyId\");\n      const messages = await listQuickMessages({\n        companyId,\n        userId: user.id\n      });\n      const options = messages.map(m => {\n        let truncatedMessage = m.message;\n        if (isString(truncatedMessage) && truncatedMessage.length > 35) {\n          truncatedMessage = m.message.substring(0, 35) + \"...\";\n        }\n        return {\n          value: m.message,\n          label: `/${m.shortcode} - ${truncatedMessage}`,\n          mediaPath: m.mediaPath\n        };\n      });\n      setQuickMessages(options);\n    }\n    fetchData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    if (isString(inputMessage) && !isEmpty(inputMessage) && inputMessage.length > 1) {\n      const firstWord = inputMessage.charAt(0);\n      setPopupOpen(firstWord.indexOf(\"/\") > -1);\n      const filteredOptions = quickMessages.filter(m => m.label.indexOf(inputMessage) > -1);\n      setOptions(filteredOptions);\n    } else {\n      setPopupOpen(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inputMessage]);\n  const onKeyPress = e => {\n    if (loading || e.shiftKey) return;else if (e.key === \"Enter\") {\n      handleSendMessage();\n    }\n  };\n  const onPaste = e => {\n    if (ticketStatus === \"open\") {\n      handleInputPaste(e);\n    }\n  };\n  const renderPlaceholder = () => {\n    if (ticketStatus === \"open\") {\n      return i18n.t(\"messagesInput.placeholderOpen\");\n    }\n    return i18n.t(\"messagesInput.placeholderClosed\");\n  };\n  const setInputRef = input => {\n    if (input) {\n      input.focus();\n      inputRef.current = input;\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.messageInputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Autocomplete, {\n    freeSolo: true,\n    open: popupOpen,\n    id: \"grouped-demo\",\n    value: inputMessage,\n    options: options,\n    closeIcon: null,\n    getOptionLabel: option => {\n      if (isObject(option)) {\n        return option.label;\n      } else {\n        return option;\n      }\n    },\n    onChange: (event, opt) => {\n      if (isObject(opt) && has(opt, \"value\") && isNil(opt.mediaPath)) {\n        setInputMessage(opt.value);\n        setTimeout(() => {\n          inputRef.current.scrollTop = inputRef.current.scrollHeight;\n        }, 200);\n      } else if (isObject(opt) && has(opt, \"value\") && !isNil(opt.mediaPath)) {\n        handleQuickAnswersClick(opt);\n        setTimeout(() => {\n          inputRef.current.scrollTop = inputRef.current.scrollHeight;\n        }, 200);\n      }\n    },\n    onInputChange: (event, opt, reason) => {\n      if (reason === \"input\") {\n        setInputMessage(event.target.value);\n      }\n    },\n    onPaste: onPaste,\n    onKeyPress: onKeyPress,\n    style: {\n      width: \"100%\"\n    },\n    renderInput: params => {\n      const {\n        InputLabelProps,\n        InputProps,\n        ...rest\n      } = params;\n      return /*#__PURE__*/React.createElement(InputBase, Object.assign({}, params.InputProps, rest, {\n        disabled: disableOption(),\n        inputRef: setInputRef,\n        placeholder: renderPlaceholder(),\n        multiline: true,\n        className: classes.messageInput,\n        maxRows: 5,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 466,\n          columnNumber: 13\n        }\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 7\n    }\n  }));\n};\nconst MessageInputCustom = props => {\n  var _medias$;\n  const {\n    ticketStatus,\n    ticketId\n  } = props;\n  const classes = useStyles();\n  const [medias, setMedias] = useState([]);\n  const [inputMessage, setInputMessage] = useState(\"\");\n  const [showEmoji, setShowEmoji] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [recording, setRecording] = useState(false);\n  const inputRef = useRef();\n  const {\n    setReplyingMessage,\n    replyingMessage\n  } = useContext(ReplyMessageContext);\n  const {\n    user\n  } = useContext(AuthContext);\n  const [signMessage, setSignMessage] = useLocalStorage(\"signOption\", true);\n  useEffect(() => {\n    inputRef.current.focus();\n  }, [replyingMessage]);\n  useEffect(() => {\n    inputRef.current.focus();\n    return () => {\n      setInputMessage(\"\");\n      setShowEmoji(false);\n      setMedias([]);\n      setReplyingMessage(null);\n    };\n  }, [ticketId, setReplyingMessage]);\n\n  // const handleChangeInput = e => {\n  // \tif (isObject(e) && has(e, 'value')) {\n  // \t\tsetInputMessage(e.value);\n  // \t} else {\n  // \t\tsetInputMessage(e.target.value)\n  // \t}\n  // };\n\n  const handleAddEmoji = e => {\n    let emoji = e.native;\n    setInputMessage(prevState => prevState + emoji);\n  };\n  const handleChangeMedias = e => {\n    if (!e.target.files) {\n      return;\n    }\n    const selectedMedias = Array.from(e.target.files);\n    setMedias(selectedMedias);\n  };\n  const handleInputPaste = e => {\n    if (e.clipboardData.files[0]) {\n      setMedias([e.clipboardData.files[0]]);\n    }\n  };\n  const handleUploadQuickMessageMedia = async (blob, message) => {\n    setLoading(true);\n    try {\n      const extension = blob.type.split(\"/\")[1];\n      const formData = new FormData();\n      const filename = `${new Date().getTime()}.${extension}`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", message);\n      formData.append(\"fromMe\", true);\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n    setLoading(false);\n  };\n  const handleQuickAnswersClick = async value => {\n    if (value.mediaPath) {\n      try {\n        const {\n          data\n        } = await axios.get(value.mediaPath, {\n          responseType: \"blob\"\n        });\n        handleUploadQuickMessageMedia(data, value.value);\n        setInputMessage(\"\");\n        return;\n        //  handleChangeMedias(response)\n      } catch (err) {\n        toastError(err);\n      }\n    }\n    setInputMessage(\"\");\n    setInputMessage(value.value);\n  };\n  const handleUploadMedia = async e => {\n    setLoading(true);\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append(\"fromMe\", true);\n    medias.forEach(media => {\n      formData.append(\"medias\", media);\n      formData.append(\"body\", media.name);\n    });\n    try {\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n    }\n    setLoading(false);\n    setMedias([]);\n  };\n  const handleSendMessage = async () => {\n    if (inputMessage.trim() === \"\") return;\n    setLoading(true);\n    const message = {\n      read: 1,\n      fromMe: true,\n      mediaUrl: \"\",\n      body: signMessage ? `*${user === null || user === void 0 ? void 0 : user.name}:*\\n${inputMessage.trim()}` : inputMessage.trim(),\n      quotedMsg: replyingMessage\n    };\n    try {\n      await api.post(`/messages/${ticketId}`, message);\n    } catch (err) {\n      toastError(err);\n    }\n    setInputMessage(\"\");\n    setShowEmoji(false);\n    setLoading(false);\n    setReplyingMessage(null);\n  };\n  const handleStartRecording = async () => {\n    setLoading(true);\n    try {\n      await navigator.mediaDevices.getUserMedia({\n        audio: true\n      });\n      await Mp3Recorder.start();\n      setRecording(true);\n      setLoading(false);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n  const handleUploadAudio = async () => {\n    setLoading(true);\n    try {\n      const [, blob] = await Mp3Recorder.stop().getMp3();\n      if (blob.size < 10000) {\n        setLoading(false);\n        setRecording(false);\n        return;\n      }\n      const formData = new FormData();\n      const filename = `audio-record-site-${new Date().getTime()}.mp3`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", filename);\n      formData.append(\"fromMe\", true);\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n    }\n    setRecording(false);\n    setLoading(false);\n  };\n  const handleCancelAudio = async () => {\n    try {\n      await Mp3Recorder.stop().getMp3();\n      setRecording(false);\n    } catch (err) {\n      toastError(err);\n    }\n  };\n  const disableOption = () => {\n    return loading || recording || ticketStatus !== \"open\";\n  };\n  const renderReplyingMessage = message => {\n    var _message$contact;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.replyginMsgWrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 679,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.replyginMsgContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 680,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: clsx(classes.replyginContactMsgSideColor, {\n        [classes.replyginSelfMsgSideColor]: !message.fromMe\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 681,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.replyginMsgBody,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 686,\n        columnNumber: 11\n      }\n    }, !message.fromMe && /*#__PURE__*/React.createElement(\"span\", {\n      className: classes.messageContactName,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 688,\n        columnNumber: 15\n      }\n    }, (_message$contact = message.contact) === null || _message$contact === void 0 ? void 0 : _message$contact.name), message.body)), /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"showRecorder\",\n      component: \"span\",\n      disabled: loading || ticketStatus !== \"open\",\n      onClick: () => setReplyingMessage(null),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 695,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ClearIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 701,\n        columnNumber: 11\n      }\n    })));\n  };\n  if (medias.length > 0) return /*#__PURE__*/React.createElement(Paper, {\n    elevation: 0,\n    square: true,\n    className: classes.viewMediaInputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 709,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"cancel-upload\",\n    component: \"span\",\n    onClick: e => setMedias([]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 710,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CancelIcon, {\n    className: classes.sendMessageIcons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 715,\n      columnNumber: 11\n    }\n  })), loading ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 719,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CircularProgress, {\n    className: classes.circleLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 720,\n      columnNumber: 13\n    }\n  })) : /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 723,\n      columnNumber: 11\n    }\n  }, (_medias$ = medias[0]) === null || _medias$ === void 0 ? void 0 : _medias$.name), /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"send-upload\",\n    component: \"span\",\n    onClick: handleUploadMedia,\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 728,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(SendIcon, {\n    className: classes.sendMessageIcons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 734,\n      columnNumber: 11\n    }\n  })));else {\n    return /*#__PURE__*/React.createElement(Paper, {\n      square: true,\n      elevation: 0,\n      className: classes.mainWrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 740,\n        columnNumber: 7\n      }\n    }, replyingMessage && renderReplyingMessage(replyingMessage), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.newMessageBox,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 742,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(EmojiOptions, {\n      disabled: disableOption(),\n      handleAddEmoji: handleAddEmoji,\n      showEmoji: showEmoji,\n      setShowEmoji: setShowEmoji,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 743,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(FileInput, {\n      disableOption: disableOption,\n      handleChangeMedias: handleChangeMedias,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(SignSwitch, {\n      width: props.width,\n      setSignMessage: setSignMessage,\n      signMessage: signMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 755,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(CustomInput, {\n      loading: loading,\n      inputRef: inputRef,\n      ticketStatus: ticketStatus,\n      inputMessage: inputMessage,\n      setInputMessage: setInputMessage\n      // handleChangeInput={handleChangeInput}\n      ,\n      handleSendMessage: handleSendMessage,\n      handleInputPaste: handleInputPaste,\n      disableOption: disableOption,\n      handleQuickAnswersClick: handleQuickAnswersClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 761,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(ActionButtons, {\n      inputMessage: inputMessage,\n      loading: loading,\n      recording: recording,\n      ticketStatus: ticketStatus,\n      handleSendMessage: handleSendMessage,\n      handleCancelAudio: handleCancelAudio,\n      handleUploadAudio: handleUploadAudio,\n      handleStartRecording: handleStartRecording,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 774,\n        columnNumber: 11\n      }\n    })));\n  }\n};\nexport default withWidth()(MessageInputCustom);","map":{"version":3,"names":["React","useState","useEffect","useContext","useRef","withWidth","isWidthUp","Picker","MicRecorder","clsx","isNil","makeStyles","Paper","InputBase","CircularProgress","green","AttachFileIcon","IconButton","MoodIcon","SendIcon","CancelIcon","ClearIcon","MicIcon","CheckCircleOutlineIcon","HighlightOffIcon","VisibilityIcon","VisibilityOffIcon","FormControlLabel","Switch","Autocomplete","isString","isEmpty","isObject","has","i18n","api","axios","RecordingTimer","ReplyMessageContext","AuthContext","useLocalStorage","toastError","useQuickMessages","Mp3Recorder","bitRate","useStyles","theme","mainWrapper","backgroundColor","palette","bordabox","display","flexDirection","alignItems","borderTop","newMessageBox","newmessagebox","width","padding","messageInputWrapper","marginRight","inputdigita","borderRadius","flex","messageInput","paddingLeft","border","sendMessageIcons","color","uploadInput","viewMediaInputWrapper","position","justifyContent","emojiBox","bottom","circleLoading","opacity","top","left","marginLeft","audioLoading","recorderWrapper","alignContent","cancelAudioIcon","sendAudioIcon","replyginMsgWrapper","paddingTop","paddingRight","replyginMsgContainer","overflowY","replyginMsgBody","height","whiteSpace","overflow","replyginContactMsgSideColor","replyginSelfMsgSideColor","messageContactName","fontWeight","EmojiOptions","props","disabled","showEmoji","setShowEmoji","handleAddEmoji","classes","createElement","Fragment","component","onClick","e","prevState","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","className","perLine","showPreview","showSkinTones","onSelect","SignSwitch","setSignMessage","signMessage","style","label","t","labelPlacement","control","size","checked","onChange","target","name","FileInput","handleChangeMedias","disableOption","multiple","type","id","htmlFor","VisibilitySwitch","setVisibility","visibility","VisibilityStatusIcon","ActionButtons","inputMessage","loading","recording","ticketStatus","handleSendMessage","handleCancelAudio","handleUploadAudio","handleStartRecording","fontSize","CustomInput","inputRef","setInputMessage","handleInputPaste","handleQuickAnswersClick","quickMessages","setQuickMessages","options","setOptions","popupOpen","setPopupOpen","user","list","listQuickMessages","fetchData","companyId","localStorage","getItem","messages","userId","map","m","truncatedMessage","message","length","substring","value","shortcode","mediaPath","firstWord","charAt","indexOf","filteredOptions","filter","onKeyPress","shiftKey","key","onPaste","renderPlaceholder","setInputRef","input","focus","current","freeSolo","open","closeIcon","getOptionLabel","option","event","opt","setTimeout","scrollTop","scrollHeight","onInputChange","reason","renderInput","params","InputLabelProps","InputProps","rest","Object","assign","placeholder","multiline","maxRows","MessageInputCustom","_medias$","ticketId","medias","setMedias","setLoading","setRecording","setReplyingMessage","replyingMessage","emoji","native","files","selectedMedias","Array","from","clipboardData","handleUploadQuickMessageMedia","blob","extension","split","formData","FormData","filename","Date","getTime","append","post","err","data","get","responseType","handleUploadMedia","preventDefault","forEach","media","trim","read","fromMe","mediaUrl","body","quotedMsg","navigator","mediaDevices","getUserMedia","audio","start","stop","getMp3","renderReplyingMessage","_message$contact","contact","elevation","square"],"sources":["/Users/kaualandi/dev/atendechat-novo-main/frontend/src/components/MessageInputCustom/index.js"],"sourcesContent":["import React, { useState, useEffect, useContext, useRef } from \"react\";\nimport withWidth, { isWidthUp } from \"@material-ui/core/withWidth\";\nimport \"emoji-mart/css/emoji-mart.css\";\nimport { Picker } from \"emoji-mart\";\nimport MicRecorder from \"mic-recorder-to-mp3\";\nimport clsx from \"clsx\";\nimport { isNil } from \"lodash\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { green } from \"@material-ui/core/colors\";\nimport AttachFileIcon from \"@material-ui/icons/AttachFile\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MoodIcon from \"@material-ui/icons/Mood\";\nimport SendIcon from \"@material-ui/icons/Send\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport CheckCircleOutlineIcon from \"@material-ui/icons/CheckCircleOutline\";\nimport HighlightOffIcon from \"@material-ui/icons/HighlightOff\";\nimport VisibilityIcon from '@mui/icons-material/Visibility';\nimport VisibilityOffIcon from '@mui/icons-material/VisibilityOff';\nimport { FormControlLabel, Switch } from \"@material-ui/core\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport { isString, isEmpty, isObject, has } from \"lodash\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport axios from \"axios\";\n\nimport RecordingTimer from \"./RecordingTimer\";\nimport { ReplyMessageContext } from \"../../context/ReplyingMessage/ReplyingMessageContext\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { useLocalStorage } from \"../../hooks/useLocalStorage\";\nimport toastError from \"../../errors/toastError\";\n\nimport useQuickMessages from \"../../hooks/useQuickMessages\";\n\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\nconst useStyles = makeStyles((theme) => ({\n  mainWrapper: {\n    backgroundColor: theme.palette.bordabox, //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\",\n  },\n\n  newMessageBox: {\n    backgroundColor: theme.palette.newmessagebox, //DARK MODE PLW DESIGN//\n    width: \"100%\",\n    display: \"flex\",\n    padding: \"7px\",\n    alignItems: \"center\",\n  },\n\n  messageInputWrapper: {\n    padding: 6,\n    marginRight: 7,\n    backgroundColor: theme.palette.inputdigita, //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    borderRadius: 20,\n    flex: 1,\n  },\n\n  messageInput: {\n    paddingLeft: 10,\n    flex: 1,\n    border: \"none\",\n  },\n\n  sendMessageIcons: {\n    color: \"grey\",\n  },\n\n  uploadInput: {\n    display: \"none\",\n  },\n\n  viewMediaInputWrapper: {\n    display: \"flex\",\n    padding: \"10px 13px\",\n    position: \"relative\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    backgroundColor: \"#eee\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\",\n  },\n\n  emojiBox: {\n    position: \"absolute\",\n    bottom: 63,\n    width: 40,\n    borderTop: \"1px solid #e8e8e8\",\n  },\n\n  circleLoading: {\n    color: green[500],\n    opacity: \"70%\",\n    position: \"absolute\",\n    top: \"20%\",\n    left: \"50%\",\n    marginLeft: -12,\n  },\n\n  audioLoading: {\n    color: green[500],\n    opacity: \"70%\",\n  },\n\n  recorderWrapper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    alignContent: \"middle\",\n  },\n\n  cancelAudioIcon: {\n    color: \"red\",\n  },\n\n  sendAudioIcon: {\n    color: \"green\",\n  },\n\n  replyginMsgWrapper: {\n    display: \"flex\",\n    width: \"100%\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingTop: 8,\n    paddingLeft: 73,\n    paddingRight: 7,\n  },\n\n  replyginMsgContainer: {\n    flex: 1,\n    marginRight: 5,\n    overflowY: \"hidden\",\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\n    borderRadius: \"7.5px\",\n    display: \"flex\",\n    position: \"relative\",\n  },\n\n  replyginMsgBody: {\n    padding: 10,\n    height: \"auto\",\n    display: \"block\",\n    whiteSpace: \"pre-wrap\",\n    overflow: \"hidden\",\n  },\n\n  replyginContactMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#35cd96\",\n  },\n\n  replyginSelfMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#6bcbef\",\n  },\n\n  messageContactName: {\n    display: \"flex\",\n    color: \"#6bcbef\",\n    fontWeight: 500,\n  },\n}));\n\nconst EmojiOptions = (props) => {\n  const { disabled, showEmoji, setShowEmoji, handleAddEmoji } = props;\n  const classes = useStyles();\n  return (\n    <>\n      <IconButton\n        aria-label=\"emojiPicker\"\n        component=\"span\"\n        disabled={disabled}\n        onClick={(e) => setShowEmoji((prevState) => !prevState)}\n      >\n        <MoodIcon className={classes.sendMessageIcons} />\n      </IconButton>\n      {showEmoji ? (\n        <div className={classes.emojiBox}>\n          <Picker\n            perLine={16}\n            showPreview={false}\n            showSkinTones={false}\n            onSelect={handleAddEmoji}\n          />\n        </div>\n      ) : null}\n    </>\n  );\n};\n\nconst SignSwitch = (props) => {\n  const { width, setSignMessage, signMessage } = props;\n  if (isWidthUp(\"md\", width)) {\n    return (\n      <FormControlLabel\n        style={{ marginRight: 7, color: \"gray\" }}\n        label={i18n.t(\"messagesInput.signMessage\")}\n        labelPlacement=\"start\"\n        control={\n          <Switch\n            size=\"small\"\n            checked={signMessage}\n            onChange={(e) => {\n              setSignMessage(e.target.checked);\n            }}\n            name=\"showAllTickets\"\n            color=\"primary\"\n          />\n        }\n      />\n    );\n  }\n  return null;\n};\n\nconst FileInput = (props) => {\n  const { handleChangeMedias, disableOption } = props;\n  const classes = useStyles();\n  return (\n    <>\n      <input\n        multiple\n        type=\"file\"\n        id=\"upload-button\"\n        disabled={disableOption()}\n        className={classes.uploadInput}\n        onChange={handleChangeMedias}\n      />\n      <label htmlFor=\"upload-button\">\n        <IconButton\n          aria-label=\"upload\"\n          component=\"span\"\n          disabled={disableOption()}\n        >\n          <AttachFileIcon className={classes.sendMessageIcons} />\n        </IconButton>\n      </label>\n    </>\n  );\n};\n\nconst VisibilitySwitch = (props) => {\n  const { setVisibility, visibility } = props;\n  const VisibilityStatusIcon = visibility ? VisibilityIcon : VisibilityOffIcon;\n\n  return (\n    <IconButton\n      aria-label=\"visibility\"\n      component=\"span\"\n      onClick={() => setVisibility(!visibility)}\n    >\n      <VisibilityStatusIcon />\n    </IconButton>\n  )\n};\n\nconst ActionButtons = (props) => {\n  const {\n    inputMessage,\n    loading,\n    recording,\n    ticketStatus,\n    handleSendMessage,\n    handleCancelAudio,\n    handleUploadAudio,\n    handleStartRecording,\n  } = props;\n  const classes = useStyles();\n  if (inputMessage) {\n    return (\n      <IconButton\n        aria-label=\"sendMessage\"\n        component=\"span\"\n        onClick={handleSendMessage}\n        disabled={loading}\n      >\n        <SendIcon className={classes.sendMessageIcons} />\n      </IconButton>\n    );\n  } else if (recording) {\n    return (\n      <div className={classes.recorderWrapper}>\n        <IconButton\n          aria-label=\"cancelRecording\"\n          component=\"span\"\n          fontSize=\"large\"\n          disabled={loading}\n          onClick={handleCancelAudio}\n        >\n          <HighlightOffIcon className={classes.cancelAudioIcon} />\n        </IconButton>\n        {loading ? (\n          <div>\n            <CircularProgress className={classes.audioLoading} />\n          </div>\n        ) : (\n          <RecordingTimer />\n        )}\n\n        <IconButton\n          aria-label=\"sendRecordedAudio\"\n          component=\"span\"\n          onClick={handleUploadAudio}\n          disabled={loading}\n        >\n          <CheckCircleOutlineIcon className={classes.sendAudioIcon} />\n        </IconButton>\n      </div>\n    );\n  } else {\n    return (\n      <IconButton\n        aria-label=\"showRecorder\"\n        component=\"span\"\n        disabled={loading || ticketStatus !== \"open\"}\n        onClick={handleStartRecording}\n      >\n        <MicIcon className={classes.sendMessageIcons} />\n      </IconButton>\n    );\n  }\n};\n\nconst CustomInput = (props) => {\n  const {\n    loading,\n    inputRef,\n    ticketStatus,\n    inputMessage,\n    setInputMessage,\n    handleSendMessage,\n    handleInputPaste,\n    disableOption,\n    handleQuickAnswersClick,\n  } = props;\n  const classes = useStyles();\n  const [quickMessages, setQuickMessages] = useState([]);\n  const [options, setOptions] = useState([]);\n  const [popupOpen, setPopupOpen] = useState(false);\n\n  const { user } = useContext(AuthContext);\n\n  const { list: listQuickMessages } = useQuickMessages();\n\n  useEffect(() => {\n    async function fetchData() {\n      const companyId = localStorage.getItem(\"companyId\");\n      const messages = await listQuickMessages({ companyId, userId: user.id });\n      const options = messages.map((m) => {\n        let truncatedMessage = m.message;\n        if (isString(truncatedMessage) && truncatedMessage.length > 35) {\n          truncatedMessage = m.message.substring(0, 35) + \"...\";\n        }\n        return {\n          value: m.message,\n          label: `/${m.shortcode} - ${truncatedMessage}`,\n          mediaPath: m.mediaPath,\n        };\n      });\n      setQuickMessages(options);\n    }\n    fetchData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (\n      isString(inputMessage) &&\n      !isEmpty(inputMessage) &&\n      inputMessage.length > 1\n    ) {\n      const firstWord = inputMessage.charAt(0);\n      setPopupOpen(firstWord.indexOf(\"/\") > -1);\n\n      const filteredOptions = quickMessages.filter(\n        (m) => m.label.indexOf(inputMessage) > -1\n      );\n      setOptions(filteredOptions);\n    } else {\n      setPopupOpen(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inputMessage]);\n\n  const onKeyPress = (e) => {\n    if (loading || e.shiftKey) return;\n    else if (e.key === \"Enter\") {\n      handleSendMessage();\n    }\n  };\n\n  const onPaste = (e) => {\n    if (ticketStatus === \"open\") {\n      handleInputPaste(e);\n    }\n  };\n\n  const renderPlaceholder = () => {\n    if (ticketStatus === \"open\") {\n      return i18n.t(\"messagesInput.placeholderOpen\");\n    }\n    return i18n.t(\"messagesInput.placeholderClosed\");\n  };\n\n\n  const setInputRef = (input) => {\n    if (input) {\n      input.focus();\n      inputRef.current = input;\n    }\n  };\n\n  return (\n    <div className={classes.messageInputWrapper}>\n      <Autocomplete\n        freeSolo\n        open={popupOpen}\n        id=\"grouped-demo\"\n        value={inputMessage}\n        options={options}\n        closeIcon={null}\n        getOptionLabel={(option) => {\n          if (isObject(option)) {\n            return option.label;\n          } else {\n            return option;\n          }\n        }}\n        onChange={(event, opt) => {\n\n          if (isObject(opt) && has(opt, \"value\") && isNil(opt.mediaPath)) {\n            setInputMessage(opt.value);\n            setTimeout(() => {\n              inputRef.current.scrollTop = inputRef.current.scrollHeight;\n            }, 200);\n          } else if (isObject(opt) && has(opt, \"value\") && !isNil(opt.mediaPath)) {\n            handleQuickAnswersClick(opt);\n\n            setTimeout(() => {\n              inputRef.current.scrollTop = inputRef.current.scrollHeight;\n            }, 200);\n          }\n        }}\n        onInputChange={(event, opt, reason) => {\n          if (reason === \"input\") {\n            setInputMessage(event.target.value);\n          }\n        }}\n        onPaste={onPaste}\n        onKeyPress={onKeyPress}\n        style={{ width: \"100%\" }}\n        renderInput={(params) => {\n          const { InputLabelProps, InputProps, ...rest } = params;\n          return (\n            <InputBase\n              {...params.InputProps}\n              {...rest}\n              disabled={disableOption()}\n              inputRef={setInputRef}\n              placeholder={renderPlaceholder()}\n              multiline\n              className={classes.messageInput}\n              maxRows={5}\n            />\n          );\n        }}\n      />\n    </div>\n  );\n};\n\nconst MessageInputCustom = (props) => {\n  const { ticketStatus, ticketId } = props;\n  const classes = useStyles();\n\n  const [medias, setMedias] = useState([]);\n  const [inputMessage, setInputMessage] = useState(\"\");\n  const [showEmoji, setShowEmoji] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [recording, setRecording] = useState(false);\n  const inputRef = useRef();\n  const { setReplyingMessage, replyingMessage } =\n    useContext(ReplyMessageContext);\n  const { user } = useContext(AuthContext);\n\n  const [signMessage, setSignMessage] = useLocalStorage(\"signOption\", true);\n\n  useEffect(() => {\n    inputRef.current.focus();\n  }, [replyingMessage]);\n\n  useEffect(() => {\n    inputRef.current.focus();\n    return () => {\n      setInputMessage(\"\");\n      setShowEmoji(false);\n      setMedias([]);\n      setReplyingMessage(null);\n    };\n  }, [ticketId, setReplyingMessage]);\n\n  // const handleChangeInput = e => {\n  // \tif (isObject(e) && has(e, 'value')) {\n  // \t\tsetInputMessage(e.value);\n  // \t} else {\n  // \t\tsetInputMessage(e.target.value)\n  // \t}\n  // };\n\n  const handleAddEmoji = (e) => {\n    let emoji = e.native;\n    setInputMessage((prevState) => prevState + emoji);\n  };\n\n  const handleChangeMedias = (e) => {\n    if (!e.target.files) {\n      return;\n    }\n\n    const selectedMedias = Array.from(e.target.files);\n    setMedias(selectedMedias);\n  };\n\n  const handleInputPaste = (e) => {\n    if (e.clipboardData.files[0]) {\n      setMedias([e.clipboardData.files[0]]);\n    }\n  };\n\n  const handleUploadQuickMessageMedia = async (blob, message) => {\n    setLoading(true);\n    try {\n      const extension = blob.type.split(\"/\")[1];\n\n      const formData = new FormData();\n      const filename = `${new Date().getTime()}.${extension}`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", message);\n      formData.append(\"fromMe\", true);\n\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n    setLoading(false);\n  };\n\n  const handleQuickAnswersClick = async (value) => {\n    if (value.mediaPath) {\n      try {\n        const { data } = await axios.get(value.mediaPath, {\n          responseType: \"blob\",\n        });\n\n        handleUploadQuickMessageMedia(data, value.value);\n        setInputMessage(\"\");\n        return;\n        //  handleChangeMedias(response)\n      } catch (err) {\n        toastError(err);\n      }\n    }\n\n    setInputMessage(\"\");\n    setInputMessage(value.value);\n  };\n\n  const handleUploadMedia = async (e) => {\n    setLoading(true);\n    e.preventDefault();\n\n    const formData = new FormData();\n    formData.append(\"fromMe\", true);\n    medias.forEach((media) => {\n      formData.append(\"medias\", media);\n      formData.append(\"body\", media.name);\n    });\n\n    try {\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n    }\n\n    setLoading(false);\n    setMedias([]);\n  };\n\n  const handleSendMessage = async () => {\n    if (inputMessage.trim() === \"\") return;\n    setLoading(true);\n\n    const message = {\n      read: 1,\n      fromMe: true,\n      mediaUrl: \"\",\n      body: signMessage\n        ? `*${user?.name}:*\\n${inputMessage.trim()}`\n        : inputMessage.trim(),\n      quotedMsg: replyingMessage,\n    };\n    try {\n      await api.post(`/messages/${ticketId}`, message);\n    } catch (err) {\n      toastError(err);\n    }\n\n    setInputMessage(\"\");\n    setShowEmoji(false);\n    setLoading(false);\n    setReplyingMessage(null);\n  };\n\n  const handleStartRecording = async () => {\n    setLoading(true);\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n      await Mp3Recorder.start();\n      setRecording(true);\n      setLoading(false);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n\n  const handleUploadAudio = async () => {\n    setLoading(true);\n    try {\n      const [, blob] = await Mp3Recorder.stop().getMp3();\n      if (blob.size < 10000) {\n        setLoading(false);\n        setRecording(false);\n        return;\n      }\n\n      const formData = new FormData();\n      const filename = `audio-record-site-${new Date().getTime()}.mp3`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", filename);\n      formData.append(\"fromMe\", true);\n\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n    }\n\n    setRecording(false);\n    setLoading(false);\n  };\n\n  const handleCancelAudio = async () => {\n    try {\n      await Mp3Recorder.stop().getMp3();\n      setRecording(false);\n    } catch (err) {\n      toastError(err);\n    }\n  };\n\n  const disableOption = () => {\n    return loading || recording || ticketStatus !== \"open\";\n  };\n\n  const renderReplyingMessage = (message) => {\n    return (\n      <div className={classes.replyginMsgWrapper}>\n        <div className={classes.replyginMsgContainer}>\n          <span\n            className={clsx(classes.replyginContactMsgSideColor, {\n              [classes.replyginSelfMsgSideColor]: !message.fromMe,\n            })}\n          ></span>\n          <div className={classes.replyginMsgBody}>\n            {!message.fromMe && (\n              <span className={classes.messageContactName}>\n                {message.contact?.name}\n              </span>\n            )}\n            {message.body}\n          </div>\n        </div>\n        <IconButton\n          aria-label=\"showRecorder\"\n          component=\"span\"\n          disabled={loading || ticketStatus !== \"open\"}\n          onClick={() => setReplyingMessage(null)}\n        >\n          <ClearIcon className={classes.sendMessageIcons} />\n        </IconButton>\n      </div>\n    );\n  };\n\n  if (medias.length > 0)\n    return (\n      <Paper elevation={0} square className={classes.viewMediaInputWrapper}>\n        <IconButton\n          aria-label=\"cancel-upload\"\n          component=\"span\"\n          onClick={(e) => setMedias([])}\n        >\n          <CancelIcon className={classes.sendMessageIcons} />\n        </IconButton>\n\n        {loading ? (\n          <div>\n            <CircularProgress className={classes.circleLoading} />\n          </div>\n        ) : (\n          <span>\n            {medias[0]?.name}\n            {/* <img src={media.preview} alt=\"\"></img> */}\n          </span>\n        )}\n        <IconButton\n          aria-label=\"send-upload\"\n          component=\"span\"\n          onClick={handleUploadMedia}\n          disabled={loading}\n        >\n          <SendIcon className={classes.sendMessageIcons} />\n        </IconButton>\n      </Paper>\n    );\n  else {\n    return (\n      <Paper square elevation={0} className={classes.mainWrapper}>\n        {replyingMessage && renderReplyingMessage(replyingMessage)}\n        <div className={classes.newMessageBox}>\n          <EmojiOptions\n            disabled={disableOption()}\n            handleAddEmoji={handleAddEmoji}\n            showEmoji={showEmoji}\n            setShowEmoji={setShowEmoji}\n          />\n\n          <FileInput\n            disableOption={disableOption}\n            handleChangeMedias={handleChangeMedias}\n          />\n\n          <SignSwitch\n            width={props.width}\n            setSignMessage={setSignMessage}\n            signMessage={signMessage}\n          />\n\n          <CustomInput\n            loading={loading}\n            inputRef={inputRef}\n            ticketStatus={ticketStatus}\n            inputMessage={inputMessage}\n            setInputMessage={setInputMessage}\n            // handleChangeInput={handleChangeInput}\n            handleSendMessage={handleSendMessage}\n            handleInputPaste={handleInputPaste}\n            disableOption={disableOption}\n            handleQuickAnswersClick={handleQuickAnswersClick}\n          />\n\n          <ActionButtons\n            inputMessage={inputMessage}\n            loading={loading}\n            recording={recording}\n            ticketStatus={ticketStatus}\n            handleSendMessage={handleSendMessage}\n            handleCancelAudio={handleCancelAudio}\n            handleUploadAudio={handleUploadAudio}\n            handleStartRecording={handleStartRecording}\n          />\n        </div>\n      </Paper>\n    );\n  }\n};\n\nexport default withWidth()(MessageInputCustom);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}